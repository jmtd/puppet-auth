Derived from http://opensource.ok.is/trac/browser/puppet/recipies/auth/
